<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
	<meta name="theme-color" content="#33474d">
	<title>Hexo</title>
	<link rel="stylesheet" href="/css/style.css" />
	
      <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
    
<meta name="generator" content="Hexo 6.3.0"></head>

<body>

	<header class="header">
		<nav class="header__nav">
			
				<a href="/archives" class="header__link">Archive</a>
			
				<a href="/tags" class="header__link">Tags</a>
			
				<a href="/atom.xml" class="header__link">RSS</a>
			
		</nav>
		<h1 class="header__title"><a href="/">Hexo</a></h1>
		<h2 class="header__subtitle"></h2>
	</header>

	<main>
		



	<article>
	
		<h1><a href="/2023/06/12/Pyspark基础编码环境/">Pyspark基础编码环境</a></h1>
	
	<div class="article__infos">
		<span class="article__date">2023-06-12</span><br />
		
			<span class="article__category">
				<a class="article-category-link" href="/categories/%E5%B7%A5%E5%85%B7/">工具</a>
			</span><br />
		
		
			<span class="article__tags">
			  	<a class="article__tag-none-link" href="/tags/spark/" rel="tag">spark</a> <a class="article__tag-none-link" href="/tags/%E6%90%AD%E5%BB%BA/" rel="tag">搭建</a>
			</span>
		
	</div>

	

	
		<h1 id="Pyspark基础编码环境"><a href="#Pyspark基础编码环境" class="headerlink" title="Pyspark基础编码环境"></a>Pyspark基础编码环境</h1><h2 id="一、本地pysaprk环境配置"><a href="#一、本地pysaprk环境配置" class="headerlink" title="一、本地pysaprk环境配置"></a>一、本地pysaprk环境配置</h2><p>1、在出现的Anaconda命令行界面输入以下命令：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"># 创建虚拟环境 pyspark, 基于Python 3.8</span><br><span class="line"></span><br><span class="line">conda activate base</span><br><span class="line"></span><br><span class="line">conda create -n pyspark python=3.8</span><br><span class="line"></span><br><span class="line"># 切换到虚拟环境内</span><br><span class="line">conda activate pyspark</span><br><span class="line"></span><br><span class="line"># 在虚拟环境内安装包</span><br><span class="line">pip install pyspark==3.2.0 -i https://pypi.tuna.tsinghua.edu.cn/simple</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>2、Windows系统配置Anaconda<br>在资料里下载安装Anaconda3<br><figure class="figure"><img src="/../image-sparkonyarn/3.png"></figure></p>
<p>看到如下图，则安装成功<br><figure class="figure"><img src="/../image-sparkonyarn/4.png"></figure></p>
<p>3、打开上图中的 Anaconda Prompt程序，执行：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">4.conda config --set show_channel_urls yes</span><br></pre></td></tr></table></figure>
<p>用记事本打开C:\Users\用户名.condarc文件<br><figure class="figure"><img src="/../image-sparkonyarn/5.png"></figure></p>
<p>将如下内容替换进文件内,保存即可:（若没有则自行创建）<br><figure class="figure"><img src="/../image-sparkonyarn/6.png"></figure></p>
<h2 id="二、安装Pycharm专业版"><a href="#二、安装Pycharm专业版" class="headerlink" title="二、安装Pycharm专业版"></a>二、安装Pycharm专业版</h2><h2 id="三、Pycharm配置Python解释器"><a href="#三、Pycharm配置Python解释器" class="headerlink" title="三、Pycharm配置Python解释器"></a>三、Pycharm配置Python解释器</h2><p>1、配置pycharm本地python解释器<br>在pycharm中点击：</p>
<p>文件-设置-项目-Python解释器-点击右侧齿轮-Virtualenv环境<br><figure class="figure"><img src="/../image-pysaprk%E5%9F%BA%E7%A1%80%E7%BC%96%E7%A0%81%E7%8E%AF%E5%A2%83/1.png"></figure></p>
<p>Conda环境：<br><figure class="figure"><img src="/../image-pysaprk%E5%9F%BA%E7%A1%80%E7%BC%96%E7%A0%81%E7%8E%AF%E5%A2%83/2.png"></figure></p>
<p>2.配置远程 SSH Linux 解释器<br><figure class="figure"><img src="/../image-pysaprk%E5%9F%BA%E7%A1%80%E7%BC%96%E7%A0%81%E7%8E%AF%E5%A2%83/3.png"></figure><br><figure class="figure"><img src="/../image-pysaprk%E5%9F%BA%E7%A1%80%E7%BC%96%E7%A0%81%E7%8E%AF%E5%A2%83/4.png"></figure></p>
<p>3、选择远程链接的解释器位置<br>&#x2F;export&#x2F;server&#x2F;anaconda3&#x2F;envs&#x2F;pyspark&#x2F;bin&#x2F;python3.8<br><figure class="figure"><img src="/../image-pysaprk%E5%9F%BA%E7%A1%80%E7%BC%96%E7%A0%81%E7%8E%AF%E5%A2%83/5.png"></figure></p>
<p>4、查看虚拟机上是否同步pycharm中的文件<br><figure class="figure"><img src="/../image-pysaprk%E5%9F%BA%E7%A1%80%E7%BC%96%E7%A0%81%E7%8E%AF%E5%A2%83/6.png"></figure></p>
<p><figure class="figure"><img src="/../image-pysaprk%E5%9F%BA%E7%A1%80%E7%BC%96%E7%A0%81%E7%8E%AF%E5%A2%83/7.png"></figure></p>
<p>5、WordCount 代码实战<br>(1)本地准备文件 word.txt</p>
<p><figure class="figure"><img src="/../image-pysaprk%E5%9F%BA%E7%A1%80%E7%BC%96%E7%A0%81%E7%8E%AF%E5%A2%83/8.png"></figure></p>
<p>运行结果<br><figure class="figure"><img src="/../image-pysaprk%E5%9F%BA%E7%A1%80%E7%BC%96%E7%A0%81%E7%8E%AF%E5%A2%83/9.png"></figure></p>

	

	

</article>




	<article>
	
		<h1><a href="/2023/06/12/Spark On Yarn环境搭建/">Spark On Yarn</a></h1>
	
	<div class="article__infos">
		<span class="article__date">2023-06-12</span><br />
		
			<span class="article__category">
				<a class="article-category-link" href="/categories/%E5%B7%A5%E5%85%B7/">工具</a>
			</span><br />
		
		
			<span class="article__tags">
			  	<a class="article__tag-none-link" href="/tags/spark/" rel="tag">spark</a> <a class="article__tag-none-link" href="/tags/%E6%90%AD%E5%BB%BA/" rel="tag">搭建</a>
			</span>
		
	</div>

	

	
		<h1 id="Spark-On-Yarn"><a href="#Spark-On-Yarn" class="headerlink" title="Spark On Yarn"></a>Spark On Yarn</h1><p>确保Hadoop_CONF_DIR和YARN_CONF_DIR在spark-env.sh以及环境变量配置文件即可。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd /export/server/spark/</span><br><span class="line"></span><br><span class="line">vim spark-env.sh</span><br></pre></td></tr></table></figure>
<p><figure class="figure"><img src="/../image-sparkonyarn/7.png"></figure></p>
<p>1、将资料里的Anaconda3-2021.05-Linux-x86_64.sh放到&#x2F;export&#x2F;server路径下<br><figure class="figure"><img src="/../image-sparkonyarn/1.png"></figure></p>
<p>运行：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sh ./Anaconda3-2021.05-Linux-x86_64.sh</span><br></pre></td></tr></table></figure>
<p>在刚开始运行使需要多点几次空格或者直接回车<br>接下来会出现：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Do you accept the license terms? [yes|no]</span><br><span class="line">[no]&gt;&gt;&gt;yes</span><br><span class="line"></span><br><span class="line">Anaconda3 will now be installed into this location:</span><br><span class="line">[/root/anaconda3]&gt;&gt;&gt;/export/server/anaconda3</span><br><span class="line"></span><br><span class="line">Do you wish the installer to initialize Anaconda3 by running conda init ?[yes|no]</span><br><span class="line">[no]&gt;&gt;&gt;  yes</span><br><span class="line">输入yes后就安装完成了.</span><br><span class="line">安装完成后，断开连接重新连接 </span><br></pre></td></tr></table></figure>

<p>看到base开头表明安装成功<br>base是默认的虚拟环境<br><figure class="figure"><img src="/../image-sparkonyarn/2.png"></figure></p>
<p>2、Windows系统配置Anaconda<br>在资料里下载安装Anaconda3<br><figure class="figure"><img src="/../image-sparkonyarn/3.png"></figure></p>
<p>看到如下图，则安装成功<br><figure class="figure"><img src="/../image-sparkonyarn/4.png"></figure></p>
<p>3、打开上图中的 Anaconda Prompt程序，执行：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">4.conda config --set show_channel_urls yes</span><br></pre></td></tr></table></figure>
<p>用记事本打开C:\Users\用户名.condarc文件<br><figure class="figure"><img src="/../image-sparkonyarn/5.png"></figure></p>
<p>将如下内容替换进文件内,保存即可:（若没有则自行创建）<br><figure class="figure"><img src="/../image-sparkonyarn/6.png"></figure></p>
<p>4、Client模式测试</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SPARK_HOME=/export/server/spark $&#123;SPARK_HOME&#125;/bin/spark-submit --master yarn --deploy-mode client --driver-memory 512m --executor-memory 512m --num-executors 1 --total-executor-cores 2 $&#123;SPARK_HOME&#125;/examples/src/main/python/pi.py 10</span><br></pre></td></tr></table></figure>
<p><figure class="figure"><img src="/../image-sparkonyarn/8.png"></figure></p>
<p>6、cluster模式测试</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$&#123;SPARK_HOME&#125;/bin/spark-submit --master yarn --deploy-mode cluster --driver-memory 512m --executor-memory 512m --num-executors 1 --total-executor-cores 2 --conf &quot;spark.pyspark.driver.python=/export/server/anaconda3/bin/python3&quot; --conf &quot;spark.pyspark.python=/export/server/anaconda3/bin/python3&quot; $&#123;SPARK_HOME&#125;/examples/src/main/python/pi.py 10</span><br></pre></td></tr></table></figure>
<p><figure class="figure"><img src="/../image-sparkonyarn/9.png"></figure></p>

	

	

</article>




	<article>
	
		<h1><a href="/2023/06/09/Spark-standalone配置/">Spark StandAlone 环境部署</a></h1>
	
	<div class="article__infos">
		<span class="article__date">2023-06-09</span><br />
		
			<span class="article__category">
				<a class="article-category-link" href="/categories/%E5%B7%A5%E5%85%B7/">工具</a>
			</span><br />
		
		
			<span class="article__tags">
			  	<a class="article__tag-none-link" href="/tags/spark/" rel="tag">spark</a> <a class="article__tag-none-link" href="/tags/%E6%90%AD%E5%BB%BA/" rel="tag">搭建</a>
			</span>
		
	</div>

	

	
		<h1 id="Spark-StandAlone-环境部署"><a href="#Spark-StandAlone-环境部署" class="headerlink" title="Spark StandAlone 环境部署"></a>Spark StandAlone 环境部署</h1><p>1、在所有机器上安装python（Anaconda）</p>
<p>同时不要忘记 都创建pysapek虚拟环境 以及安装虚拟环境所需要的包pyspark jieba pyhive</p>
<p>2 .在所有机器配置环境变量</p>
<p>参考local模式下环境变量的配置内容</p>
<p>3、配置配置文件</p>
<p>进入到spark的配置文件目录中, cd $SPARK_HOME&#x2F;conf</p>
<p>配置workers文件</p>
<p># 改名, 去掉后面的.template后缀</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mv workers.template workers</span><br></pre></td></tr></table></figure>

<p><figure class="figure"><img src="/../images-standalone/1.png"></figure></p>
<p># 编辑worker文件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim workers</span><br></pre></td></tr></table></figure>

<p># 将里面的localhost删除, 追加</p>
<p>node1</p>
<p>node2</p>
<p>node3</p>
<p>到workers文件内</p>
<p><figure class="figure"><img src="/../images-standalone/2.png"></figure></p>
<p>配置spark-env.sh文件</p>
<p>改名</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mv spark-env.sh.template spark-env.sh</span><br></pre></td></tr></table></figure>

<p><figure class="figure"><img src="/../images-standalone/6.png"></figure></p>
<p>编辑spark-env.sh, 在底部追加如下内容</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">## 设置JAVA安装目录</span><br><span class="line">JAVA_HOME=/export/server/jdk</span><br><span class="line"></span><br><span class="line">## HADOOP软件配置文件目录，读取HDFS上文件和运行YARN集群</span><br><span class="line">HADOOP_CONF_DIR=/export/server/hadoop/etc/hadoop</span><br><span class="line">YARN_CONF_DIR=/export/server/hadoop/etc/hadoop</span><br><span class="line"></span><br><span class="line">## 指定spark老大Master的IP和提交任务的通信端口</span><br><span class="line"># 告知Spark的master运行在哪个机器上</span><br><span class="line">export SPARK_MASTER_HOST=node1</span><br><span class="line"># 告知sparkmaster的通讯端口</span><br><span class="line">export SPARK_MASTER_PORT=7077</span><br><span class="line"># 告知spark master的 webui端口</span><br><span class="line">SPARK_MASTER_WEBUI_PORT=8080</span><br><span class="line"></span><br><span class="line"># worker cpu可用核数</span><br><span class="line">SPARK_WORKER_CORES=1</span><br><span class="line"># worker可用内存</span><br><span class="line">SPARK_WORKER_MEMORY=1g</span><br><span class="line"># worker的工作通讯地址</span><br><span class="line">SPARK_WORKER_PORT=7078</span><br><span class="line"># worker的 webui地址</span><br><span class="line">SPARK_WORKER_WEBUI_PORT=8081</span><br><span class="line"></span><br><span class="line">## 设置历史服务器</span><br><span class="line"># 配置的意思是  将spark程序运行的历史日志 存到hdfs的/sparklog文件夹中</span><br><span class="line">SPARK_HISTORY_OPTS=&quot;-Dspark.history.fs.logDirectory=hdfs://node1:8020/sparklog/ -Dspark.history.fs.cleaner.enabled=true&quot;</span><br></pre></td></tr></table></figure>

<p><figure class="figure"><img src="/../images-standalone/4.png"></figure></p>
<p>在HDFS上创建程序运行历史记录存放的文件夹:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hadoop fs -mkdir /sparklog</span><br><span class="line">hadoop fs -chmod 777 /sparklog</span><br></pre></td></tr></table></figure>

<p><figure class="figure"><img src="/../images-standalone/5.png"></figure></p>
<p>配置spark-defaults.conf文件</p>
<p>改名</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mv spark-defaults.conf.template spark-defaults.conf</span><br></pre></td></tr></table></figure>

<p><figure class="figure"><img src="/../images-standalone/3.png"></figure></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mv spark-defaults.conf.template spark-defaults.conf</span><br></pre></td></tr></table></figure>

<p>修改内容, 追加如下内容</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># 开启spark的日期记录功能</span><br><span class="line">spark.eventLog.enabled 	true</span><br><span class="line"># 设置spark日志记录的路径</span><br><span class="line">spark.eventLog.dir	 hdfs://node1:8020/sparklog/ </span><br><span class="line"># 设置spark日志是否启动压缩</span><br><span class="line">spark.eventLog.compress 	true</span><br></pre></td></tr></table></figure>

<p><figure class="figure"><img src="/../images-standalone/7.png"></figure></p>
<p>配置log4j.properties 文件 [可选配置]</p>
<p>改名</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mv log4j.properties.template log4j.properties</span><br></pre></td></tr></table></figure>

<p><figure class="figure"><img src="/../image-docker/8.png"></figure></p>
<p>修改内容(参考下图)</p>
<p>将INFO修改为WARN</p>
<p><figure class="figure"><img src="/../images-standalone/9.png"></figure></p>
<p>将spark安装文件夹分发到其他服务器上</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">scp -r spark-3.1.2-bin-hadoop3.2 node2:/export/server/</span><br><span class="line">scp -r spark-3.1.2-bin-hadoop3.2 node3:/export/server/</span><br></pre></td></tr></table></figure>
<p>并在node2、node3给spark安装目录增加软连接</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ln -s /export/server/spark-3.1.2-bin-hadoop3.2 /export/server/spark</span><br></pre></td></tr></table></figure>
<p><figure class="figure"><img src="/../images-standalone/10.png"></figure><br><figure class="figure"><img src="/../images-standalone/11.png"></figure></p>
<p>检查每台机器的<br>JAVA_HOME<br>SPARK_HOME<br>PYSPARK_PYTHON<br>等等 环境变量是否正常指向正确的目录<br>启动历史服务器：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sbin/start-history-server.sh</span><br></pre></td></tr></table></figure>
<p><figure class="figure"><img src="/../images-standalone/12.png"></figure></p>
<p>启动spark的master和worker进程</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sbin/start-all.sh	</span><br></pre></td></tr></table></figure>
<p><figure class="figure"><img src="/../images-standalone/13.png"></figure></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jps</span><br></pre></td></tr></table></figure>
<p><figure class="figure"><img src="/../images-standalone/14.png"></figure></p>
<p>查看master的WEB UI<br><figure class="figure"><img src="/../images-standalone/15.png"></figure></p>

	

	

</article>




	<article>
	
		<h1><a href="/2023/06/09/Spark(local)/">Spark(local)环境部署</a></h1>
	
	<div class="article__infos">
		<span class="article__date">2023-06-09</span><br />
		
			<span class="article__category">
				<a class="article-category-link" href="/categories/%E5%B7%A5%E5%85%B7/">工具</a>
			</span><br />
		
		
			<span class="article__tags">
			  	<a class="article__tag-none-link" href="/tags/spark/" rel="tag">spark</a> <a class="article__tag-none-link" href="/tags/%E6%90%AD%E5%BB%BA/" rel="tag">搭建</a>
			</span>
		
	</div>

	

	
		<h1 id="Spark-Local环境部署"><a href="#Spark-Local环境部署" class="headerlink" title="Spark Local环境部署"></a>Spark Local环境部署</h1><h2 id="一、创建虚拟环境"><a href="#一、创建虚拟环境" class="headerlink" title="一、创建虚拟环境"></a>一、创建虚拟环境</h2><p>1、需将Python环境需要安装到Linux(虚拟机)和Windows(本机)上</p>
<p>在windows环境安装Anaconda，在三台服务器分别配置Anaconda</p>
<p>在Windows环境下，用Anaconda自带的命令行界面创建虚拟环境</p>
<p><figure class="figure"><img src="E:\blog\source\images-spark(local)\1.png"></figure></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">conda create -n pyspark python=3.8</span><br><span class="line"># 切换到虚拟环境内</span><br><span class="line">conda activate pyspark</span><br><span class="line"># 在虚拟环境内安装包</span><br><span class="line">pip install pyhive pyspark jieba -i https://pypi.tuna.tsinghua.edu.cn/simple </span><br><span class="line">（#切换pyspark版本</span><br><span class="line">pip uninstall pyspark</span><br><span class="line">pip install pyspark==3.2.0 -i https://pypi.tuna.tsinghua.edu.cn/simple）</span><br></pre></td></tr></table></figure>

<p>2、最终配置好的状态：</p>
<p><figure class="figure"><img src="E:\blog\source\images-spark(local)\2.png"></figure></p>
<p>3、配置spark的环境变量</p>
<p><figure class="figure"><img src="E:\blog\source\images-spark(local)\3.png"></figure></p>
<p>4、上传spark-3.2.0-bin-hadoop3.2.tgz到Linux服务器中</p>
<p>解压并创建软链接</p>
<p><figure class="figure"><img src="E:\blog\source\images-spark(local)\4.png"></figure></p>
<p>5、进行测试</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(base) [root@node1 bin]# ./pyspark</span><br></pre></td></tr></table></figure>

<p><figure class="figure"><img src="E:\blog\source\images-spark(local)\5.png"></figure></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sc.parallelize([1,2,3,4,5]).map(lambda x: x + 1).collect()</span><br></pre></td></tr></table></figure>

<p><figure class="figure"><img src="E:\blog\source\images-spark(local)\6.png"></figure></p>
<p>Web UI (4040)</p>
<p>Spark程序在运行的时候, 会绑定到机器的4040端口上.</p>
<p><figure class="figure"><img src="E:\blog\source\images-spark(local)\7.png"></figure></p>
<p>4040端口是一个WEBUI端口, 可以在浏览器内打开:</p>
<p><figure class="figure"><img src="E:\blog\source\images-spark(local)\8.png"></figure></p>
<p>打开监控页面后, 可以发现 在程序内仅有一个Driver</p>
<p>因为我们是Local模式, Driver即管理又干活</p>
<p>同时, 输入jps</p>
<p><figure class="figure"><img src="E:\blog\source\images-spark(local)\9.png"></figure></p>

	

	

</article>




	<article>
	
		<h1><a href="/2023/06/09/docker/">Docker安装</a></h1>
	
	<div class="article__infos">
		<span class="article__date">2023-06-09</span><br />
		
		
	</div>

	

	
		<h1 id="Docker"><a href="#Docker" class="headerlink" title="Docker"></a>Docker</h1><h2 id="一、安装docker"><a href="#一、安装docker" class="headerlink" title="一、安装docker"></a>一、安装docker</h2><p>1.Centos安装Docker</p>
<p>2.机器环境初始化<br>  如果之前安装过旧版本的Docker，先卸载</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">yum remove docker \</span><br><span class="line">                  docker-client \</span><br><span class="line">                  docker-client-latest \</span><br><span class="line">                  docker-common \</span><br><span class="line">                  docker-latest \</span><br><span class="line">                  docker-latest-logrotate \</span><br><span class="line">                  docker-logrotate \</span><br><span class="line">                  docker-selinux \</span><br><span class="line">                  docker-engine-selinux \</span><br><span class="line">                  docker-engine \</span><br><span class="line">                  docker-ce</span><br></pre></td></tr></table></figure>
<p>3.Yum原配置</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">#备份配置文件</span><br><span class="line">mv /etc/yum.repos.d/CentOS-Base.repo /etc/yum.repos.d/CentOS-Base.repo.backup</span><br><span class="line"></span><br><span class="line">wget -O /etc/yum.repos.d/CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-7.repo</span><br><span class="line"></span><br><span class="line">wget -O /etc/yum.repos.d/epel.repo http://mirrors.aliyun.com/repo/epel-7.repo</span><br><span class="line"></span><br><span class="line">yum clean all</span><br><span class="line">yum makecache</span><br><span class="line"></span><br><span class="line">#可选操作</span><br><span class="line">yum install -y bash-completion vim lrzsz wget expect net-tools nc nmap treedos2unix htop iftop iotop unzip telnet sl psmisc nethogs glances bc ntpdate openldap-devel</span><br></pre></td></tr></table></figure>
<p>4.安装yum工具</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">yum install -y yum-utils \</span><br><span class="line">           device-mapper-persistent-data \</span><br><span class="line">           lvm2 --skip-broken</span><br></pre></td></tr></table></figure>

<p>5.配置网卡转发</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">#1.docker必须安装在centos7平台，内核版本不低于3.10在centos平台运行docker可能会遇见些告警信息，修改内核配置参数，打开内核转发功能</span><br><span class="line">#写入</span><br><span class="line">cat &lt;&lt;EOF &gt; /etc/sysctl.d/docker.conf</span><br><span class="line">net.bridge.bridge-nf-call-ip6tables = 1</span><br><span class="line">net.bridge.bridge-nf-call-iptables = 1</span><br><span class="line">net.ipv4.conf.default.rp_filter = 0</span><br><span class="line">net.ipv4.conf.all.rp_filter = 0</span><br><span class="line">net.ipv4.ip_forward=1</span><br><span class="line">EOF</span><br><span class="line">#2.重新加载内核参数</span><br><span class="line">modprobe br_netfilter</span><br><span class="line">sysctl -p /etc/sysctl.d/docker.conf</span><br></pre></td></tr></table></figure>
<p>6.利用yum进行dockers安装</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"># 提前配置好yum仓库</span><br><span class="line"># 1.阿里云自带仓库 2.阿里云提供的docker专属repo仓库</span><br><span class="line"></span><br><span class="line">curl -o /etc/yum.repos.d/docker-ce.repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo</span><br><span class="line">curl -o /etc/yum.repos.d/Centos-7.repo http://mirrors.aliyun.com/repo/Centos-7.repo</span><br><span class="line">#更新yum缓存</span><br><span class="line">yum clean all &amp;&amp; yum makecache</span><br><span class="line">#可以直接yum安装docker了</span><br><span class="line">## 查看源中可用版本</span><br><span class="line">yum list docker-ce --showduplicates | sort -r</span><br><span class="line">## yum安装</span><br><span class="line">yum install docker-ce -y</span><br><span class="line">## 如果需要安装旧版本</span><br><span class="line">yum install -y docker-ce-20.10.6</span><br><span class="line">##查看docker版本，验证是否验证成功</span><br><span class="line">docker -v</span><br><span class="line">##如果要卸载</span><br><span class="line">yum remove -y docker-ce-xxx</span><br></pre></td></tr></table></figure>
<p>7.配置镜像加速器</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">#用于加速镜像文件下载,选用阿里云镜像站</span><br><span class="line">mkdir -p /etc/docker</span><br><span class="line">touch /etc/docker/daemon.json</span><br><span class="line">vim /etc/docker/daemon.json</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">&quot;registry-mirrors&quot; : [</span><br><span class="line">&quot;https://8xpk5wnt.mirror.aliyuncs.com&quot;</span><br><span class="line">]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>8.启动docker</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#启动docker前，一定要关闭防火墙后！！</span><br><span class="line"># 关闭</span><br><span class="line">systemctl stop firewalld</span><br><span class="line"># 禁止开机启动防火墙</span><br><span class="line">systemctl disable firewalld</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">##通过命令启动docker：</span><br><span class="line">#systemctl start docker  # 启动docker服务</span><br><span class="line">#systemctl stop docker  # 停止docker服务</span><br><span class="line">#systemctl restart docker  # 重启docker服务</span><br><span class="line"></span><br><span class="line">#我们使用如下命令进行docker启动</span><br><span class="line">##docker配置文件重新加载</span><br><span class="line">systemctl daemon-reload</span><br><span class="line">##设置开启自启动</span><br><span class="line">systemctl enable docker</span><br><span class="line">#启动docker</span><br><span class="line">systemctl start docker</span><br><span class="line"></span><br><span class="line">## 查看docker信息</span><br><span class="line">docker info</span><br><span class="line">docker ps</span><br><span class="line">docker images</span><br><span class="line">docker version</span><br><span class="line"></span><br><span class="line">## docker-client</span><br><span class="line">which docker</span><br><span class="line">## docker daemon</span><br><span class="line">ps aux |grep docker</span><br><span class="line">## containerd</span><br><span class="line">ps aux|grep containerd</span><br><span class="line">systemctl status containerd</span><br></pre></td></tr></table></figure>
<p><figure class="figure"><img src="/../image-docker/1.png"></figure></p>
<h2 id="二、docker基本操作"><a href="#二、docker基本操作" class="headerlink" title="二、docker基本操作"></a>二、docker基本操作</h2><p>1.运行镜像</p>
<p>2.查看镜像是否在运行<br><figure class="figure"><img src="/../image-docker/2.png"></figure></p>
<p>3.访问网站<br><figure class="figure"><img src="/../image-docker/3.png"></figure></p>
<p>4.停止容器<br><figure class="figure"><img src="/../image-docker/4.png"></figure></p>
<p>5.查看docker镜像的存储路径<br><figure class="figure"><img src="/../image-docker/9.png"></figure></p>
<p>6.查看具体位置<br><figure class="figure"><img src="/../image-docker/10.png"></figure></p>
<p>7.指定tag查看镜像</p>
<p>docker images centos:7.8.2003<br><figure class="figure"><img src="/../image-docker/11.png"></figure></p>
<p>8.只列出镜像id</p>
<p>docker images -q</p>
<p><figure class="figure"><img src="/../image-docker/12.png"></figure></p>
<p>9.练习<br>需求：去DockerHub搜索并拉取一个Redis镜像<br>目标：<br>1）去DockerHub搜索Redis镜像</p>
<p>2）查看Redis镜像的名称和版本</p>
<p>3）利用docker pull命令拉取镜像</p>
<p>4）利用docker save命令将 redis:latest打包为一个redis.tar包</p>
<p><figure class="figure"><img src="/../image-docker/7.jpg"></figure></p>
<p>5）利用docker rmi 删除本地的redis:latest</p>
<p>6）利用docker load 重新加载 redis.tar文件<br><figure class="figure"><img src="/../image-docker/5.jpg"></figure></p>
<h1 id="三、容器初体验"><a href="#三、容器初体验" class="headerlink" title="三、容器初体验"></a>三、容器初体验</h1><p>1.运行容器，且进入容器内，且在容器内执行某个命令<br>docker run -it centos:7.8.2003 sh<br><figure class="figure"><img src="/../image-docker/13.png"></figure></p>
<p>cat &#x2F;etc&#x2F;redhat-release<br><figure class="figure"><img src="/../image-docker/14.png"></figure></p>
<p>2.数据卷操作</p>
<p>查看所有数据：docker volume ls<br><figure class="figure"><img src="/../image-docker/5.jpg"></figure></p>
<p>创建数据卷：docker volume create html<br><figure class="figure"><img src="/../image-docker/8.png"></figure></p>
<p>可以看到我们创建的html这个数据卷关联的宿主机目录为：<br>&#x2F;var&#x2F;lib&#x2F;docker&#x2F;volume&#x2F;html&#x2F;_data目录。</p>

	

	

</article>




	<article>
	
		<h1><a href="/2023/06/09/Hive3安装/">Hive3安装</a></h1>
	
	<div class="article__infos">
		<span class="article__date">2023-06-09</span><br />
		
		
	</div>

	

	
		<h1 id="Hive3安装"><a href="#Hive3安装" class="headerlink" title="Hive3安装"></a>Hive3安装</h1><h2 id="一、Mysql安装"><a href="#一、Mysql安装" class="headerlink" title="一、Mysql安装"></a>一、Mysql安装</h2><p>卸载Centos7自带的mariadb</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@node1 ~]# rpm -qa|grep mariadb</span><br><span class="line">mariadb-libs-5.5.64-1.el7.x86_64</span><br><span class="line"></span><br><span class="line">[root@node1 ~]# rpm -e mariadb-libs-5.5.64-1.el7.x86_64 --nodeps</span><br><span class="line">[root@node1 ~]# rpm -qa|grep mariadb                            </span><br><span class="line">[root@node1 ~]# </span><br></pre></td></tr></table></figure>

<p>安装mysql</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">mkdir /export/server/mysql</span><br><span class="line"></span><br><span class="line">#上传mysql-5.7.29-1.el7.x86_64.rpm-bundle.tar 到上述文件夹下  解压</span><br><span class="line">tar xvf mysql-5.7.29-1.el7.x86_64.rpm-bundle.tar</span><br><span class="line"></span><br><span class="line">#执行安装</span><br><span class="line">yum -y install libaio</span><br><span class="line"></span><br><span class="line">[root@node1 mysql]rpm -ivh mysql-community-common-5.7.29-1.el7.x86_64.rpm mysql-community-libs-5.7.29-1.el7.x86_64.rpm mysql-community-client-5.7.29-1.el7.x86_64.rpm mysql-community-server-5.7.29-1.el7.x86_64.rpm </span><br><span class="line"></span><br><span class="line">warning: mysql-community-common-5.7.29-1.el7.x86_64.rpm: Header V3 DSA/SHA1 Signature, key ID 5072e1f5: NOKEY</span><br><span class="line">Preparing...                          ################################# [100%]</span><br><span class="line">Updating / installing...</span><br><span class="line">   1:mysql-community-common-5.7.29-1.e################################# [ 25%]</span><br><span class="line">   2:mysql-community-libs-5.7.29-1.el7################################# [ 50%]</span><br><span class="line">   3:mysql-community-client-5.7.29-1.e################################# [ 75%]</span><br><span class="line">   4:mysql-community-server-5.7.29-1.e################                  ( 49%)</span><br></pre></td></tr></table></figure>

<p>mysql初始化设置</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">#初始化</span><br><span class="line">mysqld --initialize</span><br><span class="line"></span><br><span class="line">#更改所属组</span><br><span class="line">chown mysql:mysql /var/lib/mysql -R</span><br><span class="line"></span><br><span class="line">#启动mysql</span><br><span class="line">systemctl start mysqld.service</span><br><span class="line"></span><br><span class="line">#查看生成的临时root密码</span><br><span class="line">cat  /var/log/mysqld.log</span><br><span class="line"></span><br><span class="line">[Note] A temporary password is generated for root@localhost: o+TU+KDOm004</span><br></pre></td></tr></table></figure>
<p>修改root密码 授权远程访问 设置开机自启动</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">[root@node1 ~]# mysql -u root -p</span><br><span class="line">Enter password:     #这里输入在日志中生成的临时密码</span><br><span class="line">Welcome to the MySQL monitor.  Commands end with ; or \g.</span><br><span class="line">Your MySQL connection id is 3</span><br><span class="line">Server version: 5.7.29</span><br><span class="line"></span><br><span class="line">Copyright (c) 2000, 2020, Oracle and/or its affiliates. All rights reserved.</span><br><span class="line"></span><br><span class="line">Oracle is a registered trademark of Oracle Corporation and/or its</span><br><span class="line">affiliates. Other names may be trademarks of their respective</span><br><span class="line">owners.</span><br><span class="line"></span><br><span class="line">Type &#x27;help;&#x27; or &#x27;\h&#x27; for help. Type &#x27;\c&#x27; to clear the current input statement.</span><br><span class="line"></span><br><span class="line">mysql&gt; </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#更新root密码  设置为hadoop</span><br><span class="line">mysql&gt; alter user user() identified by &quot;hadoop&quot;;</span><br><span class="line">Query OK, 0 rows affected (0.00 sec)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#授权</span><br><span class="line">mysql&gt; use mysql;</span><br><span class="line"></span><br><span class="line">mysql&gt; GRANT ALL PRIVILEGES ON *.* TO &#x27;root&#x27;@&#x27;%&#x27; IDENTIFIED BY &#x27;hadoop&#x27; WITH GRANT OPTION;</span><br><span class="line"></span><br><span class="line">mysql&gt; FLUSH PRIVILEGES; </span><br><span class="line"></span><br><span class="line">#mysql的启动和关闭 状态查看 （这几个命令必须记住）</span><br><span class="line">systemctl stop mysqld</span><br><span class="line">systemctl status mysqld</span><br><span class="line">systemctl start mysqld</span><br><span class="line"></span><br><span class="line">#建议设置为开机自启动服务</span><br><span class="line">[root@node1 ~]# systemctl enable  mysqld                             </span><br><span class="line">Created symlink from /etc/systemd/system/multi-user.target.wants/mysqld.service to /usr/lib/systemd/system/mysqld.service.</span><br><span class="line"></span><br><span class="line">#查看是否已经设置自启动成功</span><br><span class="line">[root@node1 ~]# systemctl list-unit-files | grep mysqld</span><br><span class="line">mysqld.service                                enabled </span><br></pre></td></tr></table></figure>

<p>Centos7 干净卸载mysql 5.7</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">#关闭mysql服务</span><br><span class="line">systemctl stop mysqld.service</span><br><span class="line"></span><br><span class="line">#查找安装mysql的rpm包</span><br><span class="line">[root@node3 ~]# rpm -qa | grep -i mysql      </span><br><span class="line">mysql-community-libs-5.7.29-1.el7.x86_64</span><br><span class="line">mysql-community-common-5.7.29-1.el7.x86_64</span><br><span class="line">mysql-community-client-5.7.29-1.el7.x86_64</span><br><span class="line">mysql-community-server-5.7.29-1.el7.x86_64</span><br><span class="line"></span><br><span class="line">#卸载</span><br><span class="line">[root@node1 ~]# yum remove mysql-community-libs-5.7.29-1.el7.x86_64 mysql-community-common-5.7.29-1.el7.x86_64 mysql-community-client-5.7.29-1.el7.x86_64 mysql-community-server-5.7.29-1.el7.x86_64</span><br><span class="line"></span><br><span class="line">#查看是否卸载干净</span><br><span class="line">rpm -qa | grep -i mysql</span><br><span class="line"></span><br><span class="line">#查找mysql相关目录 删除</span><br><span class="line">[root@node1 ~]# find / -name mysql</span><br><span class="line">/var/lib/mysql</span><br><span class="line">/var/lib/mysql/mysql</span><br><span class="line">/usr/share/mysql</span><br><span class="line"></span><br><span class="line">[root@node1 ~]# rm -rf /var/lib/mysql</span><br><span class="line">[root@node1 ~]# rm -rf /var/lib/mysql/mysql</span><br><span class="line">[root@node1 ~]# rm -rf /usr/share/mysql</span><br><span class="line"></span><br><span class="line">#删除默认配置 日志</span><br><span class="line">rm -rf /etc/my.cnf </span><br><span class="line">rm -rf /var/log/mysqld.log</span><br></pre></td></tr></table></figure>
<h2 id="Hive的安装"><a href="#Hive的安装" class="headerlink" title="Hive的安装"></a>Hive的安装</h2><p>上传安装包 解压</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">tar zxvf apache-hive-3.1.2-bin.tar.gz</span><br><span class="line">ln -s apache-hive-3.1.2-bin hive</span><br></pre></td></tr></table></figure>

<p>解决Hive与Hadoop之间guava版本差异</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd /export/server/hive/</span><br><span class="line">rm -rf lib/guava-19.0.jar</span><br><span class="line">cp /export/server/hadoop/share/hadoop/common/lib/guava-27.0-jre.jar ./lib/</span><br></pre></td></tr></table></figure>

<p>修改配置文件<br>hive-env.sh</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">cd /export/server/hive/conf</span><br><span class="line">mv hive-env.sh.template hive-env.sh</span><br><span class="line"></span><br><span class="line">vim hive-env.sh</span><br><span class="line">export HADOOP_HOME=/export/server/hadoop</span><br><span class="line">export HIVE_CONF_DIR=/export/server/hive/conf</span><br><span class="line">export HIVE_AUX_JARS_PATH=/export/server/hive/lib</span><br></pre></td></tr></table></figure>

<p>hive-site.xml</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">&lt;configuration&gt;</span><br><span class="line">&lt;!-- 存储元数据mysql相关配置 --&gt;</span><br><span class="line">&lt;property&gt;</span><br><span class="line">	&lt;name&gt;javax.jdo.option.ConnectionURL&lt;/name&gt;</span><br><span class="line">	&lt;value&gt;jdbc:mysql://node1:3306/hive3?createDatabaseIfNotExist=true&amp;amp;useSSL=false&amp;amp;useUnicode=true&amp;amp;characterEncoding=UTF-8&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br><span class="line"></span><br><span class="line">&lt;property&gt;</span><br><span class="line">	&lt;name&gt;javax.jdo.option.ConnectionDriverName&lt;/name&gt;</span><br><span class="line">	&lt;value&gt;com.mysql.jdbc.Driver&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br><span class="line"></span><br><span class="line">&lt;property&gt;</span><br><span class="line">	&lt;name&gt;javax.jdo.option.ConnectionUserName&lt;/name&gt;</span><br><span class="line">	&lt;value&gt;root&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br><span class="line"></span><br><span class="line">&lt;property&gt;</span><br><span class="line">	&lt;name&gt;javax.jdo.option.ConnectionPassword&lt;/name&gt;</span><br><span class="line">	&lt;value&gt;hadoop&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- H2S运行绑定host --&gt;</span><br><span class="line">&lt;property&gt;</span><br><span class="line">    &lt;name&gt;hive.server2.thrift.bind.host&lt;/name&gt;</span><br><span class="line">    &lt;value&gt;node1&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- 远程模式部署metastore metastore地址 --&gt;</span><br><span class="line">&lt;property&gt;</span><br><span class="line">    &lt;name&gt;hive.metastore.uris&lt;/name&gt;</span><br><span class="line">    &lt;value&gt;thrift://node1:9083&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- 关闭元数据存储授权  --&gt; </span><br><span class="line">&lt;property&gt;</span><br><span class="line">    &lt;name&gt;hive.metastore.event.db.notification.api.auth&lt;/name&gt;</span><br><span class="line">    &lt;value&gt;false&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br><span class="line">&lt;/configuration&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>上传mysql jdbc驱动到hive安装包lib下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql-connector-java-5.1.32.jar</span><br></pre></td></tr></table></figure>

<p>初始化元数据</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cd /export/server/hive/</span><br><span class="line"></span><br><span class="line">bin/schematool -initSchema -dbType mysql -verbos</span><br><span class="line">#初始化成功会在mysql中创建74张表</span><br></pre></td></tr></table></figure>

<p>在hdfs创建hive存储目录（如存在则不用操作）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">hadoop fs -mkdir /tmp</span><br><span class="line">hadoop fs -mkdir -p /user/hive/warehouse</span><br><span class="line">hadoop fs -chmod g+w /tmp</span><br><span class="line">hadoop fs -chmod g+w /user/hive/warehouse</span><br></pre></td></tr></table></figure>

<p>&#x3D;&#x3D;启动hive&#x3D;&#x3D;</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">###1、启动metastore服务</span><br><span class="line"></span><br><span class="line">#前台启动  关闭ctrl+c</span><br><span class="line">/export/server/hive/bin/hive --service metastore</span><br><span class="line"></span><br><span class="line">#前台启动开启debug日志</span><br><span class="line">/export/server/hive/bin/hive --service metastore --hiveconf hive.root.logger=DEBUG,console  </span><br><span class="line"></span><br><span class="line">#后台启动 进程挂起  关闭使用jps+ kill -9</span><br><span class="line">nohup /export/server/hive/bin/hive --service metastore &amp;</span><br></pre></td></tr></table></figure>

<p>2、启动hiveserver2服务</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">nohup /export/server/hive/bin/hive --service hiveserver2 &amp;</span><br><span class="line"></span><br><span class="line">#注意 启动hiveserver2需要一定的时间  不要启动之后立即beeline连接 可能连接不上</span><br></pre></td></tr></table></figure>

<p>3、beeline客户端连接<br>拷贝node1安装包到beeline客户端机器上（node3）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scp -r /export/server/apache-hive-3.1.2-bin/ root@node3:/export/server/</span><br></pre></td></tr></table></figure>

<p>4、连接访问</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">/export/server/hive/bin/beeline</span><br><span class="line"></span><br><span class="line">beeline&gt; ! connect jdbc:hive2://node1:10000</span><br><span class="line">beeline&gt; root</span><br><span class="line">beeline&gt; 直接回车</span><br></pre></td></tr></table></figure>
	

	

</article>




	<article>
	
		<h1><a href="/2023/06/07/hello-world/">Hello World</a></h1>
	
	<div class="article__infos">
		<span class="article__date">2023-06-07</span><br />
		
		
	</div>

	

	
		<p>Welcome to <a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a target="_blank" rel="noopener" href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a target="_blank" rel="noopener" href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a target="_blank" rel="noopener" href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/writing.html">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/server.html">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/generating.html">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>

	

	

</article>






	<span class="different-posts">📕 end of posts 📕</span>


	</main>

	<footer class="footer">
	<div class="footer-content">
		
	      <div class="footer__element">
	<p>Hi there, <br />welcome to my Blog glad you found it. Have a look around, will you?</p>
</div>

	    
	      <div class="footer__element">
	<h5>Check out</h5>
	<ul class="footer-links">
		<li class="footer-links__link"><a href="/archives">Archive</a></li>
		
		  <li class="footer-links__link"><a href="/atom.xml">RSS</a></li>
	    
		<li class="footer-links__link"><a href="/about">about page</a></li>
		<li class="footer-links__link"><a href="/tags">Tags</a></li>
		<li class="footer-links__link"><a href="/categories">Categories</a></li>
	</ul>
</div>

	    

		<div class="footer-credit">
			<span>© 2023 John Doe | Powered by <a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a> | Theme <a target="_blank" rel="noopener" href="https://github.com/HoverBaum/meilidu-hexo">MeiliDu</a></span>
		</div>

	</div>


</footer>



</body>

</html>
